<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Becoming a PowerShell God </title><style>
:root {
  --primary-color: #50241c;
  --secondary-color: #ffffff;
  --accent-color: #fcdfbb;
  --background-color: #f7e2d0;
  --text-color: #2c1b0d;
  --border-color: #dddddd;
  --header-color: #55432e;
  --section-bg: #b31f1f;
  --transition-speed: 0.3s;
}

html {
  -webkit-print-color-adjust: exact;
}

* {
  box-sizing: border-box;
  -webkit-print-color-adjust: exact;
}

html, body {
  margin: 0;
  padding: 0;
}

@media only screen {
  body {
    margin: 2em auto;
    max-width: 900px;
  }
}

body {
  font-family: Times, "Times New Roman", serif;
  line-height: 1.6;
  white-space: pre-wrap;
  color: var(--text-color);
  background-color: var(--background-color);
  padding: 20px;
  transition: color var(--transition-speed), background-color var(--transition-speed);
}

.page-body {
  background-color: var(--background-color);
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
  border-radius: 20px;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.1);
}

a, a.visited {
  color: var(--primary-color);
  text-decoration: none;
  border-bottom: 1px dotted var(--primary-color);
  font-size: 0.88em;
  transition: color var(--transition-speed), border-color var(--transition-speed);
}

a:hover {
  color: var(--text-color);
  background-color: #f5cdb3;
  border-bottom: 1px solid var(--text-color);
}

.page-title {
  border-bottom-style: solid;
  font-size: 2.5em;
  font-weight: 700;
  margin-top: 0;
  margin-bottom: 0.75em;
  color: var(--primary-color);
  text-align: center;
  transition: color var(--transition-speed);
}

h1, h2, h3 {
  letter-spacing: -0.01em;
  line-height: 1.2;
  font-weight: 600;
  margin-bottom: 0;
  color: var(--header-color);
  transition: color var(--transition-speed);
}

h1 {
  font-size: 2em;
  margin-top: 1.875rem;
}

h2 {
  font-size: 1.6em;
  margin-top: 1.5rem;
}

h3 {
  font-size: 1.25rem;
  margin-top: 1.25rem;
}

h1 strong, h2 strong, h3 strong {
  font-weight: 600;
}

.page-cover-image {
  display: block;
  object-fit: cover;
  width: 100%;
  max-height: 30vh;
  border-radius: 10px;
  box-shadow: 0 0 5px rgba(40, 15, 28, 0.3);
}

hr {
  background: transparent;
  display: block;
  width: 100%;
  height: 1px;
  visibility: visible;
  border: none;
  border-bottom: 1px solid var(--accent-color);
}

img {
  max-width: 100%;
  border-radius: 10px;
  box-shadow: 0 0 5px rgba(40, 15, 28, 0.3);
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

figure {
  margin: 1.25em 0;
  page-break-inside: avoid;
}

.link-to-page {
  margin: 1em 0;
  padding: 0;
  border: none;
  font-weight: 500;
}

.link-to-page a {
  font-size: 1em;
}

.link-to-page a:hover {
}

blockquote {
  font-size: 1em;
  margin: 1em 0;
  padding-left: 1em;
  border-left: 3px solid var(--primary-color);
}

.code, code {
  background: rgba(80, 36, 28, 0.08);
  border-radius: 3px;
  padding: 0.2em 0.4em;
  font-size: 85%;
  tab-size: 2;
  font-family: monospace;
}

code {
  color: var(--primary-color);
}

.code {
  padding: 1.5em 1em;
}

table, th, td {
  border: 1px solid var(--accent-color);
  border-collapse: collapse;
}

table {
  border-left: none;
  border-right: none;
}

th, td {
  font-weight: normal;
  padding: 0.25em 0.5em;
  line-height: 1.5;
  min-height: 1.5em;
  text-align: left;
}

th {
  color: var(--header-color);
}

ol, ul {
  margin: 0;
  margin-block-start: 0.6em;
  margin-block-end: 0.6em;
}

ul > li {
  list-style: disc;
}

ul {
  padding-inline-start: 1.7em;
}

ol {
  padding-inline-start: 1.6em;
}

.page-description {
  margin-bottom: 2em;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

article {
  animation: fadeIn 0.5s ease-out forwards;
}

.sans { font-family: Times, "Times New Roman", serif; }

img.icon, img.bookmark-icon {
  max-width: 16px;
  max-height: 16px;
  box-shadow: none;
  border-radius: 0;
  display: inline;
  vertical-align: text-bottom;
}

@media only print {
  img {
    max-height: 100vh;
    object-fit: contain;
  }
}

@page {
  margin: 1in;
}
</style></head><body>
<p id="go-back-link" style="margin:1em 0;"><a href="../Windows%20Server%20&%20Active%20Directory.html" style="font-size:1em;">&larr; Go Back</a></p>
<article id="29ea1ef9-8d73-8087-a4d7-d65f73f2e80d" class="page sans"><header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/woodcuts_9.jpg" style="object-position:center 0%"/><h1 class="page-title" dir="auto">Becoming a PowerShell God </h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-8006-86f4-cf4e74970a89"/></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-80c0-8591-d1dcb279e1c8"/></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-80b0-bb0e-c9f820206ae7"/></div><div style="display:contents" dir="auto"><blockquote id="2a2a1ef9-8d73-80b6-8760-ea46fb2d8a45" class="block-color-gray quote-large"><mark class="highlight-red">Space for me to record any used PowerShell commands and their usages </mark></blockquote></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-80b2-a0d4-dfa08600622a"/></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-80c4-ab6f-fa75219cc7ad"/></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-805d-a81d-c71987b5842e"/></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-8006-88fd-d2d2376d2eaa" class=""><span style="border-bottom:0.05em solid">Commands learned from: </span></p></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80bd-906e-f7366edd1277" class=""><a href="https://www.reddit.com/r/PowerShell/comments/1f1v531/powershell_cheat_sheet/">https://www.reddit.com/r/PowerShell/comments/1f1v531/powershell_cheat_sheet/</a></p></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-8057-b8c7-e7a1af7e2308" class=""><a href="https://www.ninjaone.com/blog/windows-powershell-commands-cheat-sheet/">https://www.ninjaone.com/blog/windows-powershell-commands-cheat-sheet/</a></p></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-8008-8c71-da0865461d54"/></div><div style="display:contents" dir="auto"><h2 id="2a2a1ef9-8d73-8072-8800-f7755342d865" class=""><span style="border-bottom:0.05em solid">Server Configuration</span></h2></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8094-a51f-f6f6ab46528a" class="">Set Computer Name</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-804f-b4d8-f9bd31c253ab" class=""><code>Rename-Computer -NewName &quot;DC01&quot; -Restart</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-80e4-90fa-c06ed4ee014f" class="">Set Time Zone</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-8090-a159-c8b0c12a5c7f" class=""><code>Set-TimeZone -Name &quot;Eastern Standard Time&quot;</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8095-8069-f653c1bc22bf" class="">Enable Remote Desktop</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80b2-b02d-e3231862648c" class=""><code>Set-ItemProperty -Path &#x27;HKLM:\System\CurrentControlSet\Control\Terminal Server&#x27; -Name &quot;fDenyTSConnections&quot; -Value 0<br/>Enable-NetFirewallRule -DisplayGroup &quot;Remote Desktop&quot;</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8072-94fe-d3c4f20cb57b" class="">Get Current Network Adapter Info</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-804d-8a3b-fa7430e58d4b" class=""><code>Get-NetAdapter<br/>Get-NetIPAddress</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-80aa-beef-cad6e67a4021" class="">Remove DHCP Configuration</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80eb-a0da-f838727ebd0c" class=""><code>Remove-NetIPAddress -InterfaceAlias &quot;Ethernet&quot; -Confirm:$false<br/>Remove-NetRoute -InterfaceAlias &quot;Ethernet&quot; -Confirm:$false</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8088-a8bc-f20edcb0fb11" class="">Set Static IP Address</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-8081-8bdd-c4aa50b9d064" class=""><code>New-NetIPAddress -InterfaceAlias &quot;Ethernet&quot; -IPAddress 192.168.1.10 -PrefixLength 24 -DefaultGateway 192.168.1.1</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-80a0-98b7-d2cbbd58294a" class="">Set DNS Servers</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80de-ac27-c0372322fc68" class=""><code>Set-DnsClientServerAddress -InterfaceAlias &quot;Ethernet&quot; -ServerAddresses 127.0.0.1, 8.8.8.8</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8092-a274-dea84f5abc66" class="">Verify Network Configuration</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80b4-be61-cf4d1bc7a639" class=""><code>Get-NetIPConfiguration -InterfaceAlias &quot;Ethernet&quot;<br/>Test-NetConnection -ComputerName google.com</code></p></div><div style="display:contents" dir="auto"><hr id="2a2a1ef9-8d73-8067-9ad4-d2f59c44f120"/></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8001-9b38-f069cb00177b" class="">Install DHCP Server Role</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80e5-a4fb-e98e821d8af2" class=""><code>Install-WindowsFeature DHCP -IncludeManagementTools</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-80cd-adcc-ea1e78960c2f" class="">Add DHCP Server Security Groups</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80a9-9a6c-e2067fe84b3a" class=""><code>Add-DhcpServerSecurityGroup</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8081-bf09-f8b126be6458" class="">Authorize DHCP Server in AD</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-809f-b7ed-ff565064e90d" class=""><code>Add-DhcpServerInDC -DnsName &quot;DC01.corp.contoso.com&quot; -IPAddress 192.168.1.10</code></p></div><div style="display:contents" dir="auto"><h3 id="2a2a1ef9-8d73-8065-acf5-d34e1f715db7" class="">Configure DHCP Server Settings</h3></div><div style="display:contents" dir="auto"><p id="2a2a1ef9-8d73-80a1-9ea6-f46fb3639a3f" class=""><code>Set-DhcpServerv4OptionValue -DnsServer 192.168.1.10 -DnsDomain &quot;corp.contoso.com&quot;</code></p></div><div style="display:contents" dir="auto"><hr id="2a3a1ef9-8d73-80b9-9e12-f6bf8c700ed8"/></div><div style="display:contents" dir="auto"><h3 id="2a3a1ef9-8d73-80a7-8f91-de9f55d4ad63" class="">Add new user to OU </h3></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-80e4-9501-ec907a984e3d" class=""><code>New-ADUser -Name &quot;Bob Smith&quot; -SamAccountName &quot;bsmith&quot; -UserPrincipalName &quot;bsmith@yourdomain.local&quot; -Path &quot;OU=TestUsers,OU=LAB,DC=yourdomain,DC=local&quot; -AccountPassword (ConvertTo-SecureString &quot;P@ssw0rd123!&quot; -AsPlainText -Force) -Enabled $true</code></p></div><div style="display:contents" dir="auto"><hr id="2a3a1ef9-8d73-80ec-bcdd-d5e053eeb63d"/></div><div style="display:contents" dir="auto"><h3 id="2a3a1ef9-8d73-8062-923b-e1d52ac282d5" class="">Add new group to OU </h3></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8025-9db5-cf17c4d1bd6c" class=""><code>New-ADGroup -Name &quot;LAB-Admins&quot; -GroupScope Global -GroupCategory Security -Path $groupPath -Description &quot;Lab Administrator Group&quot;</code> </p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8028-af78-ee73622502df" class="">define: $groupPath = &quot;OU=Groups,OU=LAB,DCyourdomain,DC=local&quot;</p></div><div style="display:contents" dir="auto"><hr id="2a3a1ef9-8d73-8003-9a8f-d6c1748689de"/></div><div style="display:contents" dir="auto"><h3 id="2a3a1ef9-8d73-802e-b000-fc367e216d98" class="">Add user “Bob Smith” to LAB-Admins  </h3></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8010-8f24-f11f326180ea" class=""><code>Add-ADGroupMember -Identity &quot;LAB-Admins&quot; -Members &quot;bsmith&quot;</code></p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-80f4-8e88-d7f3c646eb44" class=""><em># Check what GPOs apply to a user</em></p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-80c9-9659-c88caf14c948" class="">gpresult /r /user:yourdomain\bsmith</p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8022-acab-f6bfc28e758c" class=""><em># Force GPO update</em></p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8081-b602-e135f0ffd365" class="">gpupdate /force</p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8023-802e-f98ab00b6436" class=""><em># See GPO application for specific computer</em></p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-80bf-aa41-cc993a76eada" class="">Get-GPResultantSetOfPolicy -Computer &quot;TestPC1&quot; -User &quot;yourdomain\intern1&quot;</p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-80d1-99ac-dd62ecda9337" class=""><em># Test which GPOs are linked to an OU</em></p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-802c-a753-e0ab98eed22e" class="">Get-GPInheritance -Target &quot;OU=Restricted-Users,OU=GPO-Testing,DC=yourdomain,DC=local&quot;</p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-80cf-a832-e328babfdd27" class=""><em># Check security filtering</em></p></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8011-aebf-ecdfcaa9a0ca" class="">Get-GPPermission -Name &quot;PowerUser-Rights&quot; -All</p></div><div style="display:contents" dir="auto"><hr id="2a3a1ef9-8d73-8006-b738-feb40f131d69"/></div><div style="display:contents" dir="auto"><p id="2a3a1ef9-8d73-8093-a1de-f780a5107f34" class="">
</p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>